# 股票量化数据处理定时任务

## 任务概述

已成功创建定时任务，每个工作日（周一至周五）21:00自动执行股票数据清洗和因子计算。

## 执行顺序

1. **数据清洗脚本**: `/Users/zwldqp/work/stockquant/tradeDataClean/main.py`
2. **因子计算脚本**: `/Users/zwldqp/work/stockquant/factors/main.py`

## 相关文件

- **执行脚本**: `daily_task.sh` - 主要的执行脚本
- **Crontab配置**: `crontab_config.txt` - 定时任务配置文件
- **日志文件**: `logs/daily_task_YYYYMMDD_HHMMSS.log` - 每次执行的日志

## 管理命令

### 查看当前定时任务
```bash
crontab -l
```

### 编辑定时任务
```bash
crontab -e
```

### 重新安装定时任务
```bash
crontab /Users/zwldqp/work/stockquant/crontab_config.txt
```

### 删除所有定时任务
```bash
crontab -r
```

### 手动执行任务（测试用）
```bash
/Users/zwldqp/work/stockquant/daily_task.sh
```

## 日志查看

定时任务的执行日志保存在 `logs` 目录下，文件名格式为 `daily_task_YYYYMMDD_HHMMSS.log`。

查看最新日志：
```bash
ls -lt /Users/zwldqp/work/stockquant/logs/daily_task_*.log | head -1
tail -f /Users/zwldqp/work/stockquant/logs/daily_task_*.log
```

## 任务执行逻辑

1. 每个工作日21:00触发执行
2. 首先执行数据清洗脚本
3. 如果数据清洗成功，继续执行因子计算脚本
4. 如果数据清洗失败，任务终止，不执行因子计算
5. 所有执行过程和结果都记录在日志文件中

## 注意事项

- 确保Python环境正确配置
- 确保数据库连接正常
- 定期检查日志文件，监控任务执行状态
- 如需修改执行时间，编辑 `crontab_config.txt` 后重新安装

## 时间格式说明

Crontab时间格式：`分钟 小时 日 月 星期几`
- `0 21 * * 1-5`: 每周一到周五的21:00
- 星期几：0=周日，1=周一，2=周二，...，6=周六